<!-- Modal Export/Import -->
<div class="modal fade modal-modern" id="exportImportModal" tabindex="-1" aria-labelledby="exportImportModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exportImportModalTitle"><i class="fa fa-exchange me-2"></i><%= __('exportImport.title') %></h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <!-- Tab Navigation -->
        <ul class="nav nav-tabs nav-tabs-modern" id="exportImportTabs" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="export-tab" data-bs-toggle="tab" data-bs-target="#exportPane" type="button" role="tab">
              <i class="fa fa-download"></i> <%= __('exportImport.export') %>
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="import-tab" data-bs-toggle="tab" data-bs-target="#importPane" type="button" role="tab">
              <i class="fa fa-upload"></i> <%= __('exportImport.import') %>
            </button>
          </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="exportImportTabContent">
          <!-- Export Tab -->
          <div class="tab-pane fade show active" id="exportPane" role="tabpanel">
            <div class="export-preview" id="exportPreview">
              <div class="export-preview-loading">
                <i class="fa fa-spinner fa-spin"></i> <%= __('exportImport.loading') %>
              </div>
            </div>

            <div class="form-group-modern">
              <label class="form-label-modern"><%= __('exportImport.format') %></label>
              <div class="btn-group-modern" role="group">
                <input type="radio" class="btn-check" name="exportFormat" id="formatJson" value="json" checked>
                <label class="btn-modern btn-modern-outline" for="formatJson">
                  <i class="fa fa-code"></i> JSON
                </label>
                <input type="radio" class="btn-check" name="exportFormat" id="formatXml" value="xml">
                <label class="btn-modern btn-modern-outline" for="formatXml">
                  <i class="fa fa-file-code-o"></i> XML
                </label>
              </div>
            </div>

            <div class="form-group-modern">
              <div class="alert-modern alert-modern-info">
                <i class="fa fa-folder-open alert-icon"></i>
                <div class="alert-content">
                  <div class="alert-title"><%= __('exportImport.includeFiles') %></div>
                  <div class="alert-text"><%= __('exportImport.includeFilesDesc') %></div>
                </div>
                <label class="switch-modern" for="includeFiles">
                  <input type="checkbox" id="includeFiles" name="includeFiles">
                  <span class="slider"></span>
                </label>
              </div>
            </div>

            <div class="export-actions">
              <button type="button" class="btn-modern btn-modern-primary" onclick="performExport()">
                <i class="fa fa-download"></i> <%= __('exportImport.downloadExport') %>
              </button>
            </div>
          </div>

          <!-- Import Tab -->
          <div class="tab-pane fade" id="importPane" role="tabpanel">
            <!-- Import Source Selector -->
            <div class="import-source-tabs">
              <button type="button" class="import-source-tab active" data-source="file" onclick="switchImportSource('file')">
                <i class="fa fa-file-archive-o"></i> <%= __('exportImport.uploadFile') %>
              </button>
              <button type="button" class="import-source-tab" data-source="git" onclick="switchImportSource('git')">
                <i class="fa fa-git"></i> <%= __('exportImport.gitRepository') %>
              </button>
              <button type="button" class="import-source-tab" data-source="directory" onclick="switchImportSource('directory')">
                <i class="fa fa-folder-o"></i> <%= __('exportImport.importDirectory') %>
              </button>
            </div>

            <!-- File Upload Source -->
            <div id="importSourceFile" class="import-source-content">
              <div class="form-group-modern">
                <label class="form-label-modern"><%= __('exportImport.selectFile') %></label>
                <div class="file-upload-wrapper">
                  <input type="file" class="form-control-modern" id="importFile" accept=".zip" onchange="handleImportFileSelect(event)">
                  <div id="importFileInfo" class="file-info" style="display: none;">
                    <i class="fa fa-file-archive-o"></i>
                    <span id="importFileName"></span>
                    <span id="importFileSize" class="file-size"></span>
                  </div>
                </div>
                <small style="color: var(--text-muted); margin-top: 0.5rem; display: block;">
                  <%= __('exportImport.fileFormat') %>
                </small>
              </div>
            </div>

            <!-- Git Repository Source -->
            <div id="importSourceGit" class="import-source-content" style="display: none;">
              <div class="form-group-modern">
                <label class="form-label-modern"><%= __('exportImport.gitRepoUrl') %> *</label>
                <input type="text" class="form-control-modern" id="gitRepoUrl" placeholder="https://github.com/user/repo.git">
                <small style="color: var(--text-muted); margin-top: 0.5rem; display: block;">
                  <%= __('exportImport.gitRepoUrlHelp') %>
                </small>
              </div>

              <div class="form-row-modern">
                <div class="form-group-modern" style="flex: 1;">
                  <label class="form-label-modern"><%= __('exportImport.gitBranch') %></label>
                  <input type="text" class="form-control-modern" id="gitBranch" placeholder="main">
                  <small style="color: var(--text-muted); margin-top: 0.5rem; display: block;">
                    <%= __('exportImport.gitBranchHelp') %>
                  </small>
                </div>
                <div class="form-group-modern" style="flex: 1;">
                  <label class="form-label-modern"><%= __('exportImport.gitCommit') %></label>
                  <input type="text" class="form-control-modern" id="gitCommit" placeholder="abc123...">
                  <small style="color: var(--text-muted); margin-top: 0.5rem; display: block;">
                    <%= __('exportImport.gitCommitHelp') %>
                  </small>
                </div>
              </div>

              <div class="form-group-modern">
                <label class="form-label-modern"><%= __('exportImport.gitSshKey') %></label>
                <textarea class="form-control-modern" id="gitSshKey" rows="4" placeholder="-----BEGIN OPENSSH PRIVATE KEY-----&#10;...&#10;-----END OPENSSH PRIVATE KEY-----"></textarea>
                <small style="color: var(--text-muted); margin-top: 0.5rem; display: block;">
                  <%= __('exportImport.gitSshKeyHelp') %>
                </small>
              </div>
            </div>

            <!-- Directory Source -->
            <div id="importSourceDirectory" class="import-source-content" style="display: none;">
              <div class="directory-files-list" id="directoryFilesList">
                <div class="directory-loading">
                  <i class="fa fa-spinner fa-spin"></i> <%= __('exportImport.loading') %>
                </div>
              </div>
              <small style="color: var(--text-muted); margin-top: 0.5rem; display: block;">
                <%= __('exportImport.directoryHelp') %>
              </small>
            </div>

            <!-- Common Settings -->
            <div class="import-common-settings">
              <div class="form-group-modern">
                <label class="form-label-modern"><%= __('exportImport.conflictStrategy') %></label>
                <select class="form-control-modern form-select-modern" id="importConflictStrategy">
                  <option value="skip"><%= __('exportImport.skipExisting') %></option>
                  <option value="overwrite"><%= __('exportImport.overwriteExisting') %></option>
                  <option value="duplicate"><%= __('exportImport.duplicateExisting') %></option>
                </select>
                <small style="color: var(--text-muted); margin-top: 0.5rem; display: block;">
                  <%= __('exportImport.conflictHelp') %>
                </small>
              </div>

              <div class="form-group-modern" id="importFilesOption">
                <div class="alert-modern alert-modern-info">
                  <i class="fa fa-folder-open alert-icon"></i>
                  <div class="alert-content">
                    <div class="alert-title"><%= __('exportImport.importFiles') %></div>
                    <div class="alert-text"><%= __('exportImport.importFilesDesc') %></div>
                  </div>
                  <label class="switch-modern" for="importFilesCheck">
                    <input type="checkbox" id="importFilesCheck" name="importFilesCheck" checked>
                    <span class="slider"></span>
                  </label>
                </div>
              </div>
            </div>

            <div id="importResults" class="import-results" style="display: none;">
              <!-- Results will be shown here -->
            </div>

            <div class="import-actions">
              <button type="button" class="btn-modern btn-modern-primary" id="importBtn" onclick="performImport()" disabled>
                <i class="fa fa-upload"></i> <%= __('exportImport.startImport') %>
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn-modern btn-modern-secondary" data-bs-dismiss="modal"><%= __('buttons.close') %></button>
      </div>
    </div>
  </div>
</div>
